# Example of reaction network extracted from 
# Erban and Chapman, on (1.55) and (1.56).

# 2ğ’œ     â†’ âˆ…
# ğ’œ + â„¬ â†’ âˆ…
# âˆ…      â†’ ğ’œ
# âˆ…      â†’ â„¬
# 2ğ’     â†’ âˆ…
# ğ’ + ğ’Ÿ â†’ âˆ…
# âˆ…      â†’ ğ’
# âˆ…      â†’ ğ’Ÿ

specie = ["A", "B", "C", "D"];

#     ğ’œ  â„¬  ğ’  ğ’Ÿ
Re = [2  0   0  0;   # Kâ‚
      1  1   0  0;   # Kâ‚‚
      0  0   0  0;   # Kâ‚ƒ
      0  0   0  0;  # Kâ‚„
      0  0   2  0;   # 
      0  0   1  1;   # 
      0  0   0  0;   # 
      0  0   0  0;];  # 

#     ğ’œ  â„¬  ğ’  ğ’Ÿ
Pr = [0  0   0  0;   # Kâ‚
      0  0   0  0;   # Kâ‚‚
      1  0   0  0;   # Kâ‚ƒ
      0  1   0  0;  # Kâ‚„
      0  0   0  0;   # 
      0  0   0  0;   # 
      0  0   1  0;   # 
      0  0   0  1;]  # 

K = [1e-3;  # Kâ‚
     1e-2;  # Kâ‚‚
     1.2;   # Kâ‚ƒ
     1;    # Kâ‚„
     1e-3;  # Kâ‚
     1e-2;  # Kâ‚‚
     1.2;   # Kâ‚ƒ
     1];
ğ› = Pr - Re; # Stoichiometric balance

ğ—»â‚– = (16,16,16,16); # State-space size
A = CMEOperator(ğ›,Re,K,ğ—»â‚–);

pâ‚€ = zeros(ğ—»â‚–);
pâ‚€[1,1,1,1] = 1.0;
pâ‚€ ./= sum(pâ‚€);